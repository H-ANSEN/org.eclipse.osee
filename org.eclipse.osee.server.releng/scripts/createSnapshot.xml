<project default="createZip" name="org.eclipse.osee.server.releng/createSnapshotZip.xml - Create the snapshot zip">
	<!-- ant -file createSnapshotZip.xml "-DEXTRAFLAGS=-forceContextQualifier -fetchTag HEAD" -DBUILDTYPE=N createZip
Buildfile: createSnapshotZip.xml
-->
	<target name="createZip">
		<echo>Custom post build steps</echo>
		<property environment="env" />

		<property name="BUILDTYPE" value="I" />
		<property name="buildFolder" value="${env.WORKSPACE}/build" />
		<property name="snapshotFolder" value="${buildFolder}/../snapshot/" />

		<echo>Build folder: ${buildFolder} </echo>
		<echo>Snapshot folder: ${snapshotFolder}</echo>
		<echo>Buildtype: ${BUILDTYPE}</echo>
		<echo>Job: ${env.JOB_NAME}</echo>

		<delete quiet="true" dir="${snapshotFolder}" />

		<copy flatten="true" toDir="${snapshotFolder}" failonerror="true" includeemptydirs="false">
			<fileset dir="${buildFolder}" includes="${BUILDTYPE}*/*-Update-*.zip" />
		</copy>

		<available file="${snapshotFolder}" property="containsFile" />
		<antcall target="doMoveZip" inheritall="true" />
	</target>

	<target name="doMoveZip" if="containsFile">
		<echo>Renaming file to f-xtext-SDK-incubation-${BUILDTYPE}-Snapshot.zip</echo>
		<move includeemptydirs="false" tofile="${snapshotFolder}/osee-server-update-incubation-${BUILDTYPE}-Snapshot.zip" filtering="true">
			<fileset dir="${snapshotFolder}" includes="*-Update-*.zip" />
		</move>
	</target>
</project>
